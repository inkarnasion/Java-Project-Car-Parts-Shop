<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
	<th:block th:include="~{fragments/head}"></th:block>

</head>

<body>
	<header>
		<th:block th:include="~{fragments/navbar}"></th:block>
		<script th:src="@{/js/product-validate.js}"></script>
		<!--script th:src="@{/js/edit-product.js}"></script-->
	</header>
	<main class="mt-3">
	<h1 class="text-center text-dark">𝔼𝕕𝕚𝕥 ℙ𝕣𝕠𝕕𝕦𝕔𝕥</h1>
	<hr class="hr-2 bg-dark w-25">
	<form id="add-product-form" class="form w-25 mx-auto"
		th:action="@{/products/edit/{id}(id=${productId})}" method="post"
		enctype="multipart/form-data">
		<input type="hidden" name="_csrf"
			value="c686cd14-a7f9-4216-8009-c093b7d3df86">
		<div class="form-group">
			<label for="edit-product-name" class="font-weight-bold">ℕ𝕒𝕞𝕖</label>
			<input type="text" class="form-control text-center" placeholder="Lenght must be between 2 and 20 characters"
				id="edit-product-name" name="name" th:value="${product.name}">
			<large id="nameHelp" style="display: none" class="form-text text-muted"></large>
		</div>
		<div class="form-group">
			<label for="edit-product-description" class="font-weight-bold">𝔻𝕖𝕤𝕔𝕣𝕚𝕡𝕥𝕚𝕠𝕟</label>
			<textarea name="description" id="edit-product-description" cols="41" placeholder="Lenght must be between 2 and 50 characters"
				rows="5" th:text="${product.description}"></textarea>
			<large id="descriptionHelp" style="display: none" class="form-text text-muted"></large>
		</div>
		<div class="form-group">
			<label for="edit-product-price" class="font-weight-bold">ℙ𝕣𝕚𝕔𝕖</label>
			<input type="number" step="any" class="form-control text-center" placeholder="Input at least one number"
				id="edit-product-price" name="price" th:value="${product.price}">
			<large id="priceHelp" style="display: none" class="form-text text-muted"></large>
		</div>
		<div class="form-group">
			<label for="add-product-categories" class="font-weight-bold">ℂ𝕒𝕥𝕖𝕘𝕠𝕣𝕚𝕖𝕤</label>
			<select multiple="" class="form-control" id="add-product-categories"
				name="categories">

			</select>
		</div>
		<hr class="hr-2 bg-dark w-25">
		<div class="button-holder d-flex justify-content-center">
			<button type="submit" class="btn btn-success">𝔼𝕕𝕚𝕥
				ℙ𝕣𝕠𝕕𝕦𝕔𝕥</button>
		</div>
	</form>
	</main>
	<footer class="py-5 bg-dark">
		<th:block th:include="~{fragments/footer}"></th:block>
	</footer>
	<script>
		validFormScript();
	</script>
</body>
<script th:inline="javascript">
	fetch('/categories/fetch')
			.then((response) => response.json())
			.then((json) => {
				let categories = [[${product.categories}]];
				console.log(categories);
				json.forEach((category) =>
						$('#add-product-categories').append(
								categories.includes(category.name)
										? `<option value="${category.id}" selected>${category.name}</option>`
										: `<option value="${category.id}">${category.name}</option>`));
			})
			.catch((err) => console.log(err));
</script>
</html>